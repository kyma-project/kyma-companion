id: test-pod-3 # format: test-<resource_kind>-<test_id>
description: The Pod tries to list Pods in the same namespace using kubectl but the image does not contain kubectl.
queries:
  - user_query: Why is the Pod in error state?
    resource:
      kind: Pod
      api_version: v1
      name: pod-check
      namespace: test-pod-3 # format: test-<resource_kind>-<test_id>
    expectations:
      - name: pod_error
        statement: points out that the Pod is in an error state
        threshold: 0.5
        critical: true
      - name: pod_wrong_image
        statement: points out that the Pod uses the wrong image
        threshold: 0.5
        critical: true
      - name: pod_provide_right_image
        statement: provides the correct image to use with kubectl
        threshold: 0.5
        critical: true
      - name: pod_image_explanation
        statement: explains the connection between an image and included binaries
        threshold: 0.5
        critical: true
      - name: step_by_step_guide
        statement: provides a step-by-step guide on how to fix the issue
        threshold: 0.5
        critical: true
      - name: some_yaml
        statement: provides some yaml formatted code
        threshold: 0.5
        critical: true
      - name: partial_yaml
        statement: provides a partial yaml with the correct image 'bitnami/kubectl:latest'
        threshold: 0.5
        critical: true
      - name: complete_yaml
        statement: provides a complete yaml for the Pod with the correct image 'bitnami/kubectl:latest'
        threshold: 0.5
        critical: true
      - name: deployable_yaml
        statement: provides a complete yaml for the Pod, with the namespace set to 'test-pod-3', the serviceAccountName set to 'pod-reader-sa', the correct command and the image set to 'bitnami/kubectl:latest'
        threshold: 0.5
        critical: true
