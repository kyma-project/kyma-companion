description: The Subscription is set-up to forward events to redis svc instead of
  func1 service.
providers:
- id: file://./src/companion_provider.js
  config:
    apiUrl: ${COMPANION_API_URL}
    resource:
      kind: Subscription
      api_version: eventing.kyma-project.io/v1alpha2
      name: sub1
      namespace: test-subscription-14
prompts:
- Why the events are not being received by my function func1?
assert:
- type: llm-rubric
  value: 'Evaluate if the response points out that the sink configured in the subscription
    is incorrect.


    Score 1.0 if:

    - The response clearly and accurately points out that the sink configured in the
    subscription is incorrect

    - All relevant information is provided


    Score 0.5 if:

    - The response mentions that the sink configured in the subscription is incorrect
    but not clearly

    - Some relevant information is missing


    Score 0.0 if:

    - The response does not mention that the sink configured in the subscription is
    incorrect

    - Incorrect or misleading information

    '
  threshold: 0.7
  required: true
  description: 'subscription_wrong_sink_url: Semantic validation'
- type: llm-rubric
  value: 'Evaluate if the response provides the reason that the subscription is set-up
    to forward events to redis svc instead of func1 service.


    Score 1.0 if:

    - The response clearly and accurately provides the reason that the subscription
    is set-up to forward events to redis svc instead of func1 service

    - All relevant information is provided


    Score 0.5 if:

    - The response includes the reason that the subscription is set-up to forward
    events to redis svc instead of func1 service but not clearly

    - Some relevant information is missing


    Score 0.0 if:

    - The response does not include the reason that the subscription is set-up to
    forward events to redis svc instead of func1 service

    - Incorrect or misleading information

    '
  threshold: 0.7
  required: false
  description: 'subscription_wrong_sink_url_reason: Semantic validation'
- type: llm-rubric
  value: 'Evaluate if the response explains the use of subscriptions and how to configure
    them.


    Score 1.0 if:

    - The response clearly and accurately explains the use of subscriptions and how
    to configure them

    - All relevant information is provided


    Score 0.5 if:

    - The response explains the use of subscriptions and how to configure them but
    not clearly

    - Some relevant information is missing


    Score 0.0 if:

    - The response does not explains the use of subscriptions and how to configure
    them

    - Incorrect or misleading information

    '
  threshold: 0.7
  required: false
  description: 'subscription_explanation: Semantic validation'
- type: javascript
  value: "// Check for numbered steps or bullet points\n            const hasNumberedSteps\
    \ = /\\d+\\.\\s/.test(output);\n            const hasBulletPoints = /^\\s*[-*]\\\
    s/m.test(output);\n            return hasNumberedSteps || hasBulletPoints;"
  required: false
  description: 'step_by_step_guide: Should contain structured steps'
- type: llm-rubric
  value: 'Evaluate if the response provides a step-by-step guide on how to fix the
    issue.


    Score 1.0 if:

    - The response clearly and accurately provides a step-by-step guide on how to
    fix the issue

    - All relevant information is provided


    Score 0.5 if:

    - The response includes a step-by-step guide on how to fix the issue but not clearly

    - Some relevant information is missing


    Score 0.0 if:

    - The response does not include a step-by-step guide on how to fix the issue

    - Incorrect or misleading information

    '
  threshold: 0.7
  required: false
  description: 'step_by_step_guide: Semantic validation'
- type: contains
  value: '```'
  required: false
  description: 'partial_yaml: Must contain code block'
- type: llm-rubric
  value: 'Evaluate if the response provides a partial yaml with the correct event
    type "increase.counter.v1".


    Score 1.0 if:

    - The response clearly and accurately provides a partial yaml with the correct
    event type "increase.counter.v1"

    - All relevant information is provided


    Score 0.5 if:

    - The response includes a partial yaml with the correct event type "increase.counter.v1"
    but not clearly

    - Some relevant information is missing


    Score 0.0 if:

    - The response does not include a partial yaml with the correct event type "increase.counter.v1"

    - Incorrect or misleading information

    '
  threshold: 0.7
  required: false
  description: 'partial_yaml: Semantic validation'
- type: icontains-any
  value:
  - test-subscription-14
  - subscription
  required: false
  description: 'deployable_yaml: Must mention relevant keywords'
- type: contains
  value: '```'
  required: false
  description: 'deployable_yaml: Must contain code block'
- type: llm-rubric
  value: 'Evaluate if the response provides a complete yaml for the subscription,
    with the namespace set to ''test-subscription-14'' and the event type set to "increase.counter.v1".


    Score 1.0 if:

    - The response clearly and accurately provides a complete yaml for the subscription,
    with the namespace set to ''test-subscription-14'' and the event type set to "increase.counter.v1"

    - All relevant information is provided


    Score 0.5 if:

    - The response includes a complete yaml for the subscription, with the namespace
    set to ''test-subscription-14'' and the event type set to "increase.counter.v1"
    but not clearly

    - Some relevant information is missing


    Score 0.0 if:

    - The response does not include a complete yaml for the subscription, with the
    namespace set to ''test-subscription-14'' and the event type set to "increase.counter.v1"

    - Incorrect or misleading information

    '
  threshold: 0.7
  required: false
  description: 'deployable_yaml: Semantic validation'
metadata:
  deploy:
    script: ./data/test-cases/14_kyma_subscription_wrong_sink_url/deploy.sh
  undeploy:
    script: ./data/test-cases/14_kyma_subscription_wrong_sink_url/undeploy.sh
